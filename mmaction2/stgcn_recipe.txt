# OS : ubuntu-ja-18.04.3-desktop-amd64
# GPU_Driver :  NVIDIA-SMI 455.23.05    Driver Version: 455.23.05    CUDA Version: 11.1
# GPU : NVIDIA RTX2060

sudo apt update
sudo apt updrade
sudo apt install build-essential
conda create -n open-mmlab python=3.7 -y
conda activate open-mmlab

conda uninstall -y --force pillow pil jpeg libtiff libjpeg-turbo
pip   uninstall -y         pillow pil jpeg libtiff libjpeg-turbo
conda install -yc conda-forge libjpeg-turbo
CFLAGS="${CFLAGS} -mavx2" pip install --upgrade --no-cache-dir --force-reinstall --no-binary :all: --compile pillow-simd
conda install -y jpeg libtiff

pip install torch==1.10.1+cu111 torchvision==0.11.2+cu111 torchaudio==0.10.1 -f https://download.pytorch.org/whl/cu111/torch_stable.html
pip install git+https://github.com/open-mmlab/mim.git
mim install mmaction2 -f https://github.com/open-mmlab/mmaction2.git
pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/cu111/torch1.10.1/index.html
cd ~/PycharmProjects/open-mmlab
git clone https://github.com/open-mmlab/mmaction2.git
cd mmaction2
pip install -r requirements/build.txt
pip install -v -e . 
cd configs/recognition/tsn
pip install mmpose
pip install moviepy

# スケルトンデモ実行(pycharmの起動オプションに入力)
python demo/demo_skeleton.py demo/ntu_sample.avi demo/skeleton_demo.mp4
--config configs/skeleton/stgcn/stgcn_80e_ntu60_xsub_keypoint.py
--checkpoint https://download.openmmlab.com/mmaction/skeleton/stgcn/stgcn_80e_ntu60_xsub_keypoint/stgcn_80e_ntu60_xsub_keypoint-e7bb9653.pth
--det-config demo/faster_rcnn_r50_fpn_2x_coco.py
--det-checkpoint http://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_fpn_2x_coco/faster_rcnn_r50_fpn_2x_coco_bbox_mAP-0.384_20200504_210434-a5d8aa15.pth
--det-score-thr 0.9
--pose-config demo/hrnet_w32_coco_256x192.py
--pose-checkpoint https://download.openmmlab.com/mmpose/top_down/hrnet/hrnet_w32_coco_256x192-c78dce93_20200708.pth
--label-map tools/data/skeleton/label_map_ntu120.txt

